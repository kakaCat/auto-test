# 文档映射关系指南

## 📋 概述

本文档定义了代码变更与文档更新之间的映射关系，确保当系统功能、UI界面或交互逻辑发生变化时，能够准确、及时地更新对应的文档。

## 🎯 核心映射原则

### 1. **一对一映射原则**
- 每个前端页面对应一个用户指南文档
- 每个后端模块对应一个API文档
- 每个重要组件对应一个组件文档

### 2. **变更传播原则**
- UI变更 → 用户指南更新
- API变更 → API文档更新
- 架构变更 → 架构文档更新
- 业务逻辑变更 → 相关所有文档更新

### 3. **同步更新原则**
- 代码变更与文档更新应在同一次提交中完成
- 重大功能变更需要更新多个相关文档
- 文档更新应包含变更说明和影响范围

## 🗺️ 详细映射关系

### 前端页面 → 用户指南映射

| 前端页面路径 | 用户指南文档 | 映射关系说明 |
|-------------|-------------|-------------|
| `/dashboard` | `01-system-overview.md` | 仪表板UI变更 → 系统总览文档更新 |
| `/service-management` | `03-system-management.md` | 系统管理页面变更 → 系统管理指南更新 |
| `/api-management` | `04-api-management.md` | API管理页面变更 → API管理指南更新 |
| `/page-management` | `05-page-management.md` | 页面管理页面变更 → 页面管理指南更新 |
| `/page-call-flow` | `06-page-call-flow.md` | 页面调用流程变更 → 页面流程指南更新 |
| `/workflow-orchestration` | `07-workflow-designer.md` | 工作流设计器变更 → 工作流指南更新 |
| `/workflow-orchestration/designer` | `07-workflow-designer.md` | 工作流设计器变更 → 工作流指南更新 |
| `/scenario-management` | `08-scenario-management.md` | API测试场景管理页面变更 → API测试场景管理指南更新 |
| `/requirement-management` | `09-requirement-management.md` | 需求管理页面变更 → 需求管理指南更新 |
| `/ai-orchestration` | `10-ai-orchestration-and-execution.md` | AI编排页面变更 → AI编排指南更新 |

### 前端组件 → 文档映射

| 组件文件路径 | 相关文档 | 映射关系说明 |
|-------------|---------|-------------|
| `/src/components/SystemTree.vue` | `03-system-management.md`<br>`04-api-management.md`<br>`05-page-management.md` | SystemTree组件变更 → 所有使用该组件的页面文档更新 |
| `/src/components/WorkflowWizard.vue` | `07-workflow-designer.md` | 工作流向导组件变更 → 工作流指南更新 |
| `/src/views/*/components/*.vue` | 对应页面的用户指南 | 页面内组件变更 → 对应页面文档更新 |

### 后端API → 文档映射

| 后端API路径 | 相关文档 | 映射关系说明 |
|------------|---------|-------------|
| `/api/systems/v1/*` | `03-system-management.md`<br>`backend/api/systems.md` | 系统API变更 → 用户指南和API文档更新 |
| `/api/modules/v1/*` | `03-system-management.md`<br>`backend/api/modules.md` | 模块API变更 → 用户指南和API文档更新 |
| `/api/api-interfaces/v1/*` | `04-api-management.md`<br>`backend/api/api-interfaces.md` | API接口管理变更 → 相关文档更新 |
| `/api/pages/v1/*` | `05-page-management.md`<br>`backend/api/pages.md` | 页面API变更 → 相关文档更新 |
| `/api/workflows/v1/*` | `07-workflow-designer.md`<br>`backend/api/workflows.md` | 工作流API变更 → 相关文档更新 |
| `/api/scenarios/v1/*` | `08-scenario-management.md`<br>`backend/api/scenarios.md` | 场景API变更 → 相关文档更新 |
| `/api/requirements/v1/*` | `09-requirement-management.md`<br>`backend/api/requirements.md` | 需求API变更 → 相关文档更新 |

### 数据库变更 → 文档映射

| 数据库变更类型 | 相关文档 | 映射关系说明 |
|---------------|---------|-------------|
| 表结构变更 | `DATABASE_DESIGN.md`<br>相关页面用户指南 | 数据库表变更 → 数据库文档和相关功能文档更新 |
| 新增表 | `DATABASE_DESIGN.md`<br>`SYSTEM_ARCHITECTURE.md`<br>相关功能文档 | 新增表 → 多个文档需要更新 |
| 删除表 | `DATABASE_DESIGN.md`<br>所有相关功能文档 | 删除表 → 清理所有相关文档引用 |
| 字段变更 | `DATABASE_DESIGN.md`<br>相关API文档<br>相关用户指南 | 字段变更 → 数据流相关文档更新 |

## 🔄 具体更新场景

### 场景1: UI界面变更

#### 触发条件
- 页面布局调整
- 组件位置变更
- 新增/删除界面元素
- 交互流程改变

#### 更新映射
```
UI变更位置 → 对应文档更新内容

页面头部变更 → 用户指南的"界面布局"章节
左侧面板变更 → 用户指南的"界面布局"和"交互与操作"章节
右侧面板变更 → 用户指南的"界面布局"和"交互与操作"章节
对话框变更 → 用户指南的"页面弹框与抽屉"章节
工具栏变更 → 用户指南的"交互与操作"章节
```

#### 具体示例
```
变更: /service-management 页面左侧新增筛选器
↓
更新: docs/frontend/user-manuals/03-system-management.md
- 更新"界面布局"的ASCII图
- 更新"交互与操作"的筛选操作说明
- 更新"状态与数据流"的数据处理逻辑
```

### 场景2: 交互逻辑变更

#### 触发条件
- 操作流程改变
- 按钮功能调整
- 表单验证规则变更
- 数据提交方式改变

#### 更新映射
```
交互变更类型 → 对应文档章节

操作流程变更 → "交互与操作"章节
表单验证变更 → "页面弹框与抽屉"章节
数据提交变更 → "状态与数据流"章节
事件处理变更 → "事件与契约"章节
```

### 场景3: 功能新增/删除

#### 触发条件
- 新增功能模块
- 删除现有功能
- 功能重构
- 业务流程调整

#### 更新映射
```
功能变更类型 → 文档更新范围

新增功能 → 创建新文档或扩展现有文档
删除功能 → 删除相关文档内容或整个文档
功能重构 → 重写相关文档章节
流程调整 → 更新多个相关文档
```

### 场景4: API接口变更

#### 触发条件
- 新增API接口
- 修改API参数
- 删除API接口
- API响应格式变更

#### 更新映射
```
API变更类型 → 文档更新内容

新增API → 后端API文档 + 相关用户指南
修改API → 后端API文档 + 相关用户指南的数据流章节
删除API → 清理所有相关文档的API引用
响应格式变更 → 后端API文档 + 前端数据模型章节
```

## 📝 文档更新检查清单

### UI/交互变更检查清单

#### 变更前检查
- [ ] 确认变更的具体页面和组件
- [ ] 识别受影响的用户指南文档
- [ ] 评估变更对用户操作流程的影响
- [ ] 确认是否需要更新多个文档

#### 文档更新检查
- [ ] 更新ASCII界面布局图
- [ ] 更新操作步骤说明
- [ ] 更新交互流程描述
- [ ] 更新相关截图或示例
- [ ] 检查文档内部链接的有效性

#### 更新后验证
- [ ] 文档内容与实际功能一致
- [ ] 操作步骤可以正确执行
- [ ] 所有相关文档已同步更新
- [ ] 文档格式符合标准规范

### API变更检查清单

#### 变更前检查
- [ ] 确认API变更的具体内容
- [ ] 识别受影响的前端页面
- [ ] 评估对用户操作的影响
- [ ] 确认向后兼容性

#### 文档更新检查
- [ ] 更新后端API文档
- [ ] 更新前端用户指南的数据流章节
- [ ] 更新相关的数据模型说明
- [ ] 更新API调用示例

#### 更新后验证
- [ ] API文档与实际接口一致
- [ ] 用户指南的操作流程正确
- [ ] 数据模型描述准确
- [ ] 示例代码可以正常运行

## 🛠️ 实际操作示例

### 示例1: 系统管理页面UI变更

#### 变更描述
在 `/service-management` 页面左侧面板新增了"系统状态筛选器"

#### 映射关系
```
代码变更:
- /frontend/src/views/service-management/index.vue (新增筛选器组件)
- /frontend/src/views/service-management/components/StatusFilter.vue (新组件)

文档更新:
- /docs/frontend/user-manuals/03-system-management.md
  - 更新"界面布局"的ASCII图，添加筛选器区域
  - 更新"交互与操作"章节，添加筛选操作说明
  - 更新"状态与数据流"章节，说明筛选逻辑
```

#### 具体更新内容
```markdown
# 在03-system-management.md中更新

## 界面布局
```
┌─────────────────────────────────────────────────────────┐
│ 左侧面板 (Left Panel)                                   │
│ ├─ 系统类型筛选                                         │
│ ├─ 系统状态筛选 ⭐ 新增                                 │
│ └─ SystemTree组件                                       │
└─────────────────────────────────────────────────────────┘
```

## 交互与操作
### 筛选操作 ⭐ 新增
1. **系统状态筛选**
   - 点击状态筛选下拉框
   - 选择"全部"、"启用"或"禁用"
   - 系统树自动更新显示结果
```

### 示例2: API接口变更

#### 变更描述
系统管理API新增了批量操作接口

#### 映射关系
```
代码变更:
- /backend/src/auto_test/api/systems.py (新增批量操作接口)
- /frontend/src/api/system-api.ts (新增批量操作方法)
- /frontend/src/views/service-management/index.vue (新增批量操作UI)

文档更新:
- /docs/backend/api/systems.md (新增API接口文档)
- /docs/frontend/user-manuals/03-system-management.md (新增批量操作说明)
```

### 示例3: 新功能模块

#### 变更描述
新增了"兼容性测试"功能模块

#### 映射关系
```
代码变更:
- /backend/src/auto_test/api/compatibility_tests.py (新API模块)
- /frontend/src/views/compatibility-test/ (新页面目录)
- /frontend/src/api/compatibility-test-api.ts (新API客户端)

文档更新:
- /docs/backend/api/compatibility-tests.md (新建API文档)
- /docs/frontend/user-manuals/11-compatibility-test.md (新建用户手册)
- /docs/frontend/user-manuals/README.md (更新导航)
- /docs/SYSTEM_ARCHITECTURE.md (更新架构图)
```

## 📋 文档更新模板

### UI变更文档更新模板

#### 界面布局更新
```markdown
## 界面布局 ⭐ 更新于{日期}

### 主要变更
- 新增: {新增的界面元素}
- 修改: {修改的界面元素}
- 删除: {删除的界面元素}

### 更新后布局
```
{更新后的ASCII布局图}
```

### 影响的操作流程
- {列出受影响的操作流程}
```

#### 交互操作更新
```markdown
## 交互与操作 ⭐ 更新于{日期}

### 新增操作
#### {操作名称}
1. **操作步骤**:
   - 步骤1: {具体操作}
   - 步骤2: {具体操作}
2. **预期结果**: {操作结果说明}
3. **注意事项**: {重要提醒}

### 修改的操作
#### {操作名称} (原: {原操作方式})
1. **新的操作步骤**:
   - {更新后的操作步骤}
2. **变更原因**: {变更说明}
```

### API变更文档更新模板

#### 后端API文档更新
```markdown
## API接口 ⭐ 更新于{日期}

### 新增接口
| 方法 | 路径 | 功能 | 参数 | 响应 |
|------|------|------|------|------|
| {METHOD} | {PATH} | {功能描述} | {参数说明} | {响应格式} |

### 修改的接口
| 方法 | 路径 | 变更内容 | 影响 |
|------|------|----------|------|
| {METHOD} | {PATH} | {变更说明} | {影响范围} |

### 删除的接口
- {PATH} - {删除原因}
```

#### 前端用户指南更新
```markdown
## 状态与数据流 ⭐ 更新于{日期}

### 数据流变更
- 新增数据流: {新的数据获取或处理流程}
- 修改数据流: {修改的数据处理逻辑}

### API调用变更
- 新增API调用: {新的API调用说明}
- 修改API调用: {修改的API调用方式}
```

## 🚨 重要注意事项

### 1. **变更影响评估**
- **单页面变更**: 通常只需更新对应的用户指南
- **共享组件变更**: 需要更新所有使用该组件的页面文档
- **API变更**: 需要同时更新后端API文档和前端用户指南
- **架构变更**: 可能需要更新多个层级的文档

### 2. **更新优先级**
- **高优先级**: 影响用户操作流程的变更
- **中优先级**: 界面样式和布局的调整
- **低优先级**: 内部实现细节的变更

### 3. **版本控制**
- 文档更新应与代码变更在同一个提交中
- 重大变更应在CHANGELOG.md中记录
- 文档版本号应与功能版本保持同步

### 4. **质量保证**
- 文档更新后应进行内容审查
- 确保文档与实际功能完全一致
- 定期检查文档的准确性和时效性

## 📊 映射关系矩阵

### 变更类型 vs 文档类型

| 变更类型 | 用户指南 | API文档 | 架构文档 | 组件文档 | 开发指南 |
|---------|---------|---------|----------|----------|----------|
| UI布局变更 | ✅ 必须 | ❌ 不需要 | ❌ 不需要 | 🔄 可能需要 | ❌ 不需要 |
| 交互流程变更 | ✅ 必须 | ❌ 不需要 | ❌ 不需要 | 🔄 可能需要 | ❌ 不需要 |
| API接口变更 | ✅ 必须 | ✅ 必须 | ❌ 不需要 | ❌ 不需要 | 🔄 可能需要 |
| 数据库变更 | 🔄 可能需要 | ✅ 必须 | ✅ 必须 | ❌ 不需要 | ✅ 必须 |
| 新增功能 | ✅ 必须 | ✅ 必须 | ✅ 必须 | ✅ 必须 | ✅ 必须 |
| 删除功能 | ✅ 必须 | ✅ 必须 | ✅ 必须 | 🔄 可能需要 | 🔄 可能需要 |
| 组件重构 | 🔄 可能需要 | ❌ 不需要 | 🔄 可能需要 | ✅ 必须 | ✅ 必须 |
| 架构重构 | 🔄 可能需要 | 🔄 可能需要 | ✅ 必须 | 🔄 可能需要 | ✅ 必须 |

**图例**:
- ✅ 必须更新
- 🔄 可能需要更新（取决于具体变更）
- ❌ 通常不需要更新

## 📝 总结

通过建立清晰的文档映射关系，我们可以确保：

1. **及时更新**: 代码变更时能够快速识别需要更新的文档
2. **完整覆盖**: 不遗漏任何需要更新的文档
3. **准确性**: 文档内容与实际功能保持一致
4. **效率提升**: 减少文档更新的工作量和错误率

这个映射关系指南将成为团队协作和AI助手工作的重要参考，确保文档与代码的同步性和一致性。

---

**文档版本**: v1.0  
**创建时间**: 2024年1月  
**维护者**: 文档管理团队