# 页面管理页面交互文档

## 页面概述

页面管理是自动化测试平台的核心功能模块，用于管理测试页面和页面与API的关联关系。该页面提供了完整的页面生命周期管理，包括页面创建、编辑、删除、API关联管理、页面导入导出等功能。

### 核心功能特性

1. **页面配置管理**: 提供步骤向导式页面配置功能，支持页面基本信息、布局设计、API配置和交互设置
2. **分步保存机制**: 每个配置步骤完成后自动保存，支持断点续配和数据恢复，无需等到最后一步才保存
3. **可视化布局设计**: 内置拖拽式页面布局设计器，支持组件库、画布编辑和实时预览
4. **API关联配置**: 支持系统→模块→API三级选择，配置API调用顺序和参数映射
5. **交互流程设计**: 可视化交互事件配置，支持事件触发条件和执行动作设置
6. **批量操作管理**: 支持页面的批量导入、导出、启用、禁用和删除操作
7. **系统模块筛选**: 左侧树形导航支持按系统和模块筛选页面列表

## 界面布局

### 整体结构
```
┌─────────────────────────────────────────────────────────────┐
│                        页面头部                              │
│  [页面管理] [描述文本] [新增页面] [导入] [导出] [批量操作]    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────────────────────────────┐   │
│  │             │  │                                     │   │
│  │   左侧导航   │  │          右侧页面管理面板            │   │
│  │  SystemTree │  │                                     │   │
│  │             │  │  ┌─────────────────────────────┐    │   │
│  │   系统列表   │  │  │        搜索筛选区域          │    │   │
│  │   模块分类   │  │  └─────────────────────────────┘    │   │
│  │             │  │                                     │   │
│  │             │  │  ┌─────────────────────────────┐    │   │
│  │             │  │  │        页面列表展示          │    │   │
│  │             │  │  │                             │    │   │
│  │             │  │  │  [页面卡片1] [页面卡片2]    │    │   │
│  │             │  │  │  [页面卡片3] [页面卡片4]    │    │   │
│  │             │  │  │                             │    │   │
│  │             │  │  └─────────────────────────────┘    │   │
│  │             │  │                                     │   │
│  │             │  │  ┌─────────────────────────────┐    │   │
│  │             │  │  │        分页控件             │    │   │
│  │             │  │  └─────────────────────────────┘    │   │
│  └─────────────┘  └─────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 头部区域
- **页面标题**: "页面管理"
- **描述文本**: "管理测试页面和API关联关系"
- **操作按钮组**:
  - `新增页面`: 主要操作按钮，蓝色背景
  - `导入页面`: 次要操作按钮，支持批量导入
  - `导出页面`: 次要操作按钮，支持数据导出
  - `批量操作`: 下拉菜单，包含批量删除、批量更新状态等

### 左侧导航面板

#### 系统和模块树形结构 (SystemTree组件)

左侧导航面板采用SystemTree组件，提供完整的系统和模块管理功能：

**核心功能特性：**
- **层级展示**：以树形结构展示前端系统和模块的层级关系
- **系统节点**：展示各个前端系统，点击可筛选该系统下的页面
- **模块节点**：展示系统下的模块，点击可筛选该模块下的页面

**筛选功能：**
- **系统筛选**：选择系统节点时，右侧页面列表显示该系统的所有页面
- **模块筛选**：选择模块节点时，右侧页面列表显示该模块的所有页面
- **筛选状态**：导航面板显示当前选中的系统/模块状态
- **清除筛选**：支持清除当前筛选条件，显示所有页面

**交互功能：**
- **节点选择**：点击节点可筛选对应的页面列表
  - 点击系统节点：筛选该系统下所有页面
  - 点击模块节点：筛选该系统和模块对应的页面
- **展开/收起**：支持一键展开/收起所有节点
  - 点击系统节点展开或收起模块列表
- **搜索功能**：支持按系统名称和模块名称进行实时搜索
- **刷新功能**：支持重新加载系统和模块数据
- **多选支持**：支持选择多个系统/模块进行批量操作
- **右键菜单**：提供编辑、删除、添加子模块等操作

**数据来源：**
- 系统数据：通过 `apiProxy.system.getEnabledListByCategory('frontend')` 获取前端系统列表
- 模块数据：通过 `apiProxy.module.getEnabledList()` 获取启用的模块列表
- 数据关联：模块通过 `system_id` 字段关联到对应系统

**状态管理：**
- `systemTreeData`：树形结构数据
- `selectedSystemId`：当前选中的系统ID
- `selectedPageId`：当前选中的页面ID（用于模块节点选择）
- 支持节点点击事件和刷新事件处理

### 右侧页面管理面板

#### 搜索筛选区域
```
┌─────────────────────────────────────────────────────────┐
│ [搜索框: 输入页面名称或路由]  [搜索按钮]  [重置按钮]      │
├─────────────────────────────────────────────────────────┤
│ 筛选条件:                                               │
│ [页面类型▼] [状态▼] [执行类型▼] [创建时间▼] [更多筛选▼] │
└─────────────────────────────────────────────────────────┘
```

#### 页面列表展示
页面以表格形式展示，包含以下列：
```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│ 页面列表表格                                                                                 │
├──┬─────────────┬────────┬─────────────────┬──────────┬─────────────┬────────┬─────────────────┤
│☐ │ 页面名称    │ 类型   │ 路由            │ 状态     │ 系统/模块   │ API数量│ 操作            │
├──┼─────────────┼────────┼─────────────────┼──────────┼─────────────┼────────┼─────────────────┤
│☐ │ 用户登录页  │ 登录页 │ /login          │ 启用     │ 用户系统    │ 3      │ [编辑][API管理] │
│☐ │ 用户列表页  │ 列表页 │ /users          │ 启用     │ 用户系统    │ 5      │ [编辑][API管理] │
│☐ │ 订单详情页  │ 详情页 │ /order/detail   │ 禁用     │ 订单系统    │ 8      │ [编辑][API管理] │
│☐ │ 商品管理页  │ 管理页 │ /products       │ 启用     │ 商品系统    │ 12     │ [编辑][API管理] │
│☐ │ 支付页面    │ 功能页 │ /payment        │ 开发中   │ 支付系统    │ 6      │ [编辑][API管理] │
└──┴─────────────┴────────┴─────────────────┴──────────┴─────────────┴────────┴─────────────────┘

表格列说明：
- 复选框：支持多选进行批量操作
- 页面名称：页面的业务名称，可点击查看详情
- 类型：页面类型（登录页、列表页、详情页、管理页等）
- 路由：页面的访问路径
- 状态：启用、禁用、开发中等状态标签
- 系统/模块：所属系统和模块信息
- API数量：该页面关联的API接口数量
- 操作：编辑、删除、API管理、复制等操作按钮
```

## 交互流程

### 页面初始化
1. **加载系统树**: 获取系统列表并构建树形结构
2. **加载页面列表**: 获取默认的页面列表数据
3. **初始化筛选条件**: 设置默认筛选参数
4. **状态同步**: 同步URL参数和页面状态

### 页面搜索与筛选
1. **实时搜索**:
   - 用户输入关键词（页面名称或路由）
   - 300ms防抖延迟
   - 自动触发搜索请求
   - 更新页面列表

2. **条件筛选**:
   - 选择页面类型（登录页、列表页、详情页等）
   - 选择状态（启用、禁用、开发中等）
   - 选择执行类型（手动、自动化、混合）
   - 选择时间范围
   - 组合筛选条件

3. **筛选重置**:
   - 点击重置按钮
   - 清空所有筛选条件
   - 恢复默认列表

### 页面操作流程

#### 新增页面

**新增页面操作界面布局**:
```
┌─────────────────────────────────────────────────────────┐
│ 页面管理                                    [新增页面]   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │              页面配置对话框                         │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ 步骤1: 基本信息 → 步骤2: 布局设计 → 步骤3: API │ │ │
│ │ │                → 步骤4: 交互设置               │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ │                                                     │ │
│ │ [当前步骤内容区域]                                  │ │
│ │                                                     │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │              [上一步] [下一步] [取消] [保存]     │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

**操作流程**:
1. **触发操作**: 点击"新增页面"按钮
2. **打开配置弹框**: 弹出步骤向导式页面配置对话框
3. **步骤1 - 基本信息配置**:
   - 填写页面名称、路径、描述
   - 选择页面类型和图标
   - 选择所属系统和模块
   - 设置页面状态
   - **自动保存**: 验证通过后点击"下一步"自动保存基本信息并创建页面记录
4. **步骤2 - 页面布局设计**:
   - 使用可视化编辑器设计页面布局
   - 从组件库拖拽组件到画布
   - 调整组件位置和尺寸
   - 实时预览页面效果
   - **自动保存**: 布局设计完成后点击"下一步"自动保存布局配置
5. **步骤3 - API配置**:
   - 通过系统→模块→API三级选择添加API
   - 配置API调用顺序（串行/并行/条件）
   - 设置API参数映射和响应处理
   - 配置特殊API（如文件上传）
   - **自动保存**: API配置完成后点击"下一步"自动保存API配置信息
6. **步骤4 - 交互设置**:
   - 配置页面交互事件和触发条件
   - 设置执行动作和响应逻辑
   - 使用可视化流程图设计交互流程
   - **自动保存**: 交互配置完成后自动保存，页面状态变为完成
7. **分步验证**: 每个步骤完成时进行数据验证
8. **即时保存**: 每个步骤验证通过后立即保存，无需等到最后
9. **状态更新**: 页面从草稿状态变为正常状态
10. **列表刷新**: 自动刷新页面列表显示新创建的页面

##### 页面配置对话框详细说明

**对话框组件**: `PageConfigDialog.vue`

**整体设计**:
- **模态弹框**: 位于页面中心，带半透明遮罩层
- **弹框标题**: "新增页面配置" / "编辑页面配置"
- **步骤向导**: 采用步骤向导式设计，分为4个步骤
- **分步保存**: 每个步骤完成后自动保存，支持断点续配
- **底部操作**: "上一步"、"下一步"、"取消"、"保存并继续"按钮

**步骤导航**:
```
步骤1: 页面基本信息 → 步骤2: 页面布局设计 → 步骤3: API配置 → 步骤4: 页面交互设置
```

**分步保存机制**:

1. **自动保存触发**:
   - 每个步骤验证通过后自动触发保存
   - 用户点击"下一步"时保存当前步骤数据
   - 支持手动点击"保存并继续"按钮
   - 页面关闭前自动保存草稿

2. **保存策略**:
   - **步骤1保存**: 保存页面基本信息，创建页面记录，获得页面ID
   - **步骤2保存**: 保存页面布局配置，更新页面的layout字段
   - **步骤3保存**: 保存API配置信息，更新页面的apiConfig字段
   - **步骤4保存**: 保存交互配置，更新页面的interaction字段

3. **数据恢复机制**:
   - 页面配置过程中意外关闭，重新打开时恢复到上次保存的步骤
   - 支持从任意已完成的步骤继续配置
   - 显示配置进度和完成状态

4. **状态管理**:
   - **草稿状态**: 配置未完成的页面标记为草稿状态
   - **完成状态**: 所有步骤完成后页面状态变为正常
   - **步骤状态**: 每个步骤显示完成/未完成状态图标

5. **用户体验优化**:
   - 保存过程显示加载状态
   - 保存成功后显示提示信息
   - 保存失败时显示错误信息和重试选项
   - 支持离线保存，网络恢复后自动同步

#### 步骤1: 页面基本信息配置 (PageBasicInfo.vue)

**步骤1界面布局**:
```
┌─────────────────────────────────────────────────────────┐
│ 步骤1: 页面基本信息配置                                 │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 基本信息                                            │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ 页面名称 *  [________________] (0/100)          │ │ │
│ │ │ 页面路径    [________________] /path/to/page    │ │ │
│ │ │ 页面描述    ┌──────────────────────────────────┐ │ │ │
│ │ │             │                                  │ │ │ │
│ │ │             │                                  │ │ │ │
│ │ │             └──────────────────────────────────┘ │ │ │
│ │ │             (0/500)                              │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 页面配置                                            │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ 页面类型 *  [普通页面 ▼]                        │ │ │
│ │ │ 页面状态    [●] 启用  [ ] 禁用                  │ │ │
│ │ │ 页面图标    [📄] [选择图标...]                   │ │ │
│ │ │ 权限设置    [☑] 查看 [☑] 编辑 [ ] 删除          │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│                    [取消] [下一步]                      │
└─────────────────────────────────────────────────────────┘
```

**组件功能**: 配置页面的基础信息和属性设置

**基本信息区域**:
- **页面名称** (必填): 文本输入框，最大长度100字符，支持字数统计
- **页面路径**: 路由路径输入框，支持路径格式验证，留空表示无独立路由(如弹框、抽屉等)
- **页面描述**: 多行文本输入框，最大长度500字符，支持字数统计

**页面配置区域**:
- **页面类型** (必填): 下拉选择框，包含以下选项：
  - `normal`: 普通页面 - 标准的业务页面
  - `modal`: 弹框页面 - 模态对话框形式
  - `drawer`: 抽屉页面 - 侧边抽屉形式
  - `tab`: 标签页面 - 标签页内容
  - `iframe`: 嵌入页面 - 外部页面嵌入
- **页面状态**: 开关控件，启用/禁用状态切换
- **页面图标**: 图标选择器，支持Element Plus图标库和自定义图标
- **权限设置**: 多选框，配置页面基础访问权限

**表单验证**:
- 页面名称：必填，长度1-100字符
- 页面路径：可选，格式验证（以/开头的有效路径）
- 页面类型：必选
- 实时验证和错误提示

#### 步骤2: 页面布局设计 (PageLayoutDesigner.vue)

**步骤2界面布局**:
```
┌─────────────────────────────────────────────────────────┐
│ 步骤2: 页面布局设计                                     │
├─────────────────────────────────────────────────────────┤
│ ┌───────┐ ┌─────────────────────────────┐ ┌───────────┐ │
│ │[◀]组件│ │        设计画布             │ │ 属性面板[▶]│ │
│ │库     │ │ ┌─────────────────────────┐ │ │           │ │
│ │🔍搜索 │ │ │[🔍][📏][📱][💻][🖥️]    │ │ │组件属性   │ │
│ │       │ │ └─────────────────────────┘ │ │┌─────────┐│ │
│ │基础   │ │ ┌─────────────────────────┐ │ ││ID: btn1 ││ │
│ │[按钮] │ │ │                         │ │ ││类名:    ││ │
│ │[输入] │ │ │     [按钮]              │ │ ││标签:    ││ │
│ │[文本] │ │ │                         │ │ │└─────────┘│ │
│ │       │ │ │  ┌─────────────────┐    │ │ │           │ │
│ │表单   │ │ │  │     表格        │    │ │ │样式设置   │ │
│ │[表单] │ │ │  │ 列1  │ 列2 │列3 │    │ │ │┌─────────┐│ │
│ │[表格] │ │ │  │ 数据 │数据 │数据│    │ │ ││宽度:100%││ │
│ │[列表] │ │ │  └─────────────────┘    │ │ ││高度:auto││ │
│ │       │ │ │                         │ │ ││边距:10px││ │
│ │数据   │ │ │                         │ │ │└─────────┘│ │
│ │[卡片] │ │ │                         │ │ │           │ │
│ │[统计] │ │ │                         │ │ │数据绑定   │ │
│ │       │ │ └─────────────────────────┘ │ │┌─────────┐│ │
│ └───────┘ └─────────────────────────────┘ ││数据源:  ││ │
│                                             ││字段映射:││ │
│                                             │└─────────┘│ │
│                                             └───────────┘ │
├─────────────────────────────────────────────────────────┤
│                [上一步] [下一步] [取消] [保存]            │
└─────────────────────────────────────────────────────────┘

折叠状态示意:
┌─────────────────────────────────────────────────────────┐
│ 步骤2: 页面布局设计                                     │
├─────────────────────────────────────────────────────────┤
│ ┌─┐ ┌─────────────────────────────────────────────┐ ┌─┐ │
│ │▶│ │              设计画布 (扩展)                │ │◀│ │
│ │ │ │ ┌─────────────────────────────────────────┐ │ │ │ │
│ │ │ │ │[🔍][📏][📱][💻][🖥️]                  │ │ │ │ │
│ │ │ │ └─────────────────────────────────────────┘ │ │ │ │
│ │ │ │ ┌─────────────────────────────────────────┐ │ │ │ │
│ │ │ │ │                                         │ │ │ │ │
│ │ │ │ │         [按钮]                          │ │ │ │ │
│ │ │ │ │                                         │ │ │ │ │
│ │ │ │ │    ┌─────────────────────────────┐      │ │ │ │ │
│ │ │ │ │    │         表格                │      │ │ │ │ │
│ │ │ │ │    │ 列1    │ 列2   │ 列3       │      │ │ │ │ │
│ │ │ │ │    │ 数据   │ 数据  │ 数据      │      │ │ │ │ │
│ │ │ │ │    └─────────────────────────────┘      │ │ │ │ │
│ │ │ │ │                                         │ │ │ │ │
│ │ │ │ └─────────────────────────────────────────┘ │ │ │ │
│ └─┘ └─────────────────────────────────────────────┘ └─┘ │
├─────────────────────────────────────────────────────────┤
│                [上一步] [下一步] [取消] [保存]            │
└─────────────────────────────────────────────────────────┘
```

**组件功能**: 提供可视化的页面布局设计器，支持拖拽式组件编辑

**左侧组件库**:
- **面板控制**: 
  - **折叠/展开**: 支持一键折叠组件库面板，为画布腾出更多空间
  - **折叠状态**: 折叠后宽度从250px减少到50px，仅显示折叠按钮
  - **展开状态**: 完整显示组件分类和搜索功能
- **组件分类**: 按功能分类展示可用组件
  - 基础组件：按钮、输入框、文本、图片等
  - 表单组件：表单、表单项、验证器等
  - 数据展示：表格、列表、卡片、统计等
  - 导航组件：菜单、面包屑、分页等
  - 反馈组件：消息、对话框、加载等
  - 布局组件：容器、栅格、分割线等
- **组件搜索**: 支持按组件名称快速搜索
- **拖拽操作**: 支持从组件库拖拽组件到画布

**中间设计画布**:
- **画布工具栏**:
  - 缩放控制：放大、缩小、适应屏幕
  - 网格显示：开启/关闭网格辅助线
  - 预览模式：桌面、平板、手机三种预览模式
- **画布区域**:
  - 可视化编辑区域，支持组件拖拽和定位
  - 网格对齐功能，精确控制组件位置
  - 多选和批量操作支持
  - 组件层级管理（置顶、置底、上移、下移）
- **组件操作**:
  - 选中状态：显示选择框和控制点
  - 拖拽移动：支持组件位置调整
  - 尺寸调整：通过控制点调整组件大小
  - 右键菜单：复制、粘贴、删除、属性设置

**右侧属性面板**:
- **面板控制**:
  - **折叠/展开**: 支持一键折叠属性面板，最大化画布显示区域
  - **折叠状态**: 折叠后宽度从280px减少到50px，仅显示折叠按钮
  - **展开状态**: 完整显示组件属性、样式设置和数据绑定配置
- **组件属性**: 选中组件的详细属性配置
  - 基础属性：ID、类名、样式等
  - 业务属性：标签、占位符、默认值等
  - 事件属性：点击、输入、变化等事件绑定
- **样式设置**: 组件的样式属性配置
  - 布局样式：位置、尺寸、边距、内边距
  - 外观样式：颜色、字体、边框、阴影
  - 响应式：不同屏幕尺寸下的样式适配
- **数据绑定**: 组件与数据源的绑定配置

**画布功能**:
- **响应式设计**: 支持桌面、平板、手机三种预览模式
- **空间优化**: 
  - **动态尺寸**: 画布容器高度自适应视窗大小，最大化利用可用空间
  - **侧边栏联动**: 当侧边栏折叠时，画布自动扩展获得更多编辑空间
  - **最小尺寸保护**: 确保画布始终保持最小可用编辑区域
- **缩放优化**: 改进缩放计算逻辑，确保缩放后画布正确显示和铺满容器
- **实时预览**: 编辑过程中实时预览页面效果
- **撤销重做**: 支持操作历史记录和撤销重做
- **快捷键**: 支持常用快捷键操作（复制、粘贴、删除等）

##### 布局设计器优化改进 (v2.0)

**问题背景**:
原版布局设计器存在以下布局问题：
- 组件库和属性面板固定宽度，在小屏幕下挤压设计画布
- 画布区域无法充分利用可用空间
- 缩放后画布无法正确铺满容器
- 缺少响应式设计，在不同设备上体验不佳

**优化方案**:

**1. 侧边栏折叠功能**
- **左侧组件库折叠**: 支持折叠/展开切换，折叠后宽度从250px减少到50px
- **右侧属性面板折叠**: 支持折叠/展开切换，折叠后宽度从280px减少到50px
- **折叠按钮**: 在面板头部添加直观的折叠/展开按钮
- **状态保持**: 折叠状态在用户会话中保持

**2. 响应式布局优化**
- **动态高度**: 容器高度从固定600px改为`calc(100vh - 200px)`，最小高度600px
- **最小宽度保护**: 设置组件库、属性面板和画布的最小宽度，确保基本可用性
- **平滑过渡**: 添加CSS过渡动画，提供流畅的折叠/展开体验
- **多设备适配**: 针对不同屏幕尺寸（≤768px, ≤1024px）调整布局参数

**3. 画布区域优化**
- **空间最大化**: 通过侧边栏折叠，画布可获得更多显示空间
- **缩放优化**: 改进画布缩放计算逻辑，确保缩放后正确显示
- **容器自适应**: 画布容器根据内容和缩放比例动态调整尺寸
- **最小尺寸保证**: 设置画布最小宽度400px，确保基本编辑功能

**4. 用户体验提升**
- **视觉反馈**: 折叠按钮状态变化，清晰的视觉指示
- **操作便捷**: 一键折叠/展开，快速调整工作空间
- **空间利用**: 折叠后画布空间增加约530px宽度
- **设备友好**: 在平板和手机上提供更好的编辑体验

**技术实现**:
```vue
// 响应式状态管理
const leftPanelCollapsed = ref(false)
const rightPanelCollapsed = ref(false)

// 切换方法
const toggleLeftPanel = () => {
  leftPanelCollapsed.value = !leftPanelCollapsed.value
}

// 画布样式计算
const canvasContainerStyle = computed(() => {
  const baseWidth = previewMode.value === 'desktop' ? 1200 : 
                    previewMode.value === 'tablet' ? 768 : 375
  const baseHeight = 800
  
  return {
    width: `${baseWidth * canvasScale.value + 40}px`,
    height: `${baseHeight * canvasScale.value + 40}px`,
    minWidth: '100%',
    minHeight: '100%'
  }
})
```

**效果对比**:
- **优化前**: 固定布局，画布空间受限，小屏幕体验差
- **优化后**: 灵活布局，画布空间可扩展，多设备适配良好

##### 组件渲染器实现 (v2.1)

**问题背景**:
在布局设计器中，基础组件拖拽到画布后显示为透明，无法正确展示组件的可视化效果。这是因为原始的 `getComponentRenderer` 方法只返回简单的 `'div'` 元素，缺少具体的组件渲染逻辑。

**解决方案**:

**1. 组件渲染器架构设计**
- **渲染器映射系统**: 创建组件类型到渲染器的映射关系
- **模块化设计**: 每个组件类型对应独立的渲染器文件
- **统一接口**: 所有渲染器遵循相同的接口规范
- **扩展性**: 支持新组件类型的快速添加

**2. 基础组件渲染器实现**

**按钮渲染器 (ButtonRenderer.vue)**:
```vue
<template>
  <el-button
    :type="componentData.props?.type || 'primary'"
    :size="componentData.props?.size || 'default'"
    :disabled="componentData.props?.disabled || false"
    class="canvas-button"
  >
    {{ componentData.props?.text || componentData.name || '按钮' }}
  </el-button>
</template>
```
- 支持按钮类型、尺寸、禁用状态配置
- 动态显示按钮文本内容
- 完整的Element Plus按钮样式

**输入框渲染器 (InputRenderer.vue)**:
```vue
<template>
  <el-input
    :model-value="componentData.props?.value || ''"
    :placeholder="componentData.props?.placeholder || '请输入内容'"
    :disabled="componentData.props?.disabled || false"
    :type="componentData.props?.type || 'text'"
    class="canvas-input"
  />
</template>
```
- 支持输入框类型、占位符、禁用状态配置
- 提供完整的表单输入体验
- 响应式样式适配

**文本渲染器 (TextRenderer.vue)**:
```vue
<template>
  <div class="canvas-text" :style="textStyle">
    {{ componentData.props?.text || componentData.name || '文本内容' }}
  </div>
</template>

<script setup>
const textStyle = computed(() => ({
  fontSize: props.componentData.props?.fontSize || '14px',
  color: props.componentData.props?.color || '#333',
  fontWeight: props.componentData.props?.fontWeight || 'normal',
  textAlign: props.componentData.props?.textAlign || 'left'
}))
</script>
```
- 支持字体大小、颜色、对齐方式等样式配置
- 动态计算文本样式
- 自适应文本内容显示

**图片渲染器 (ImageRenderer.vue)**:
```vue
<template>
  <div class="canvas-image">
    <img
      v-if="componentData.props?.src"
      :src="componentData.props.src"
      :alt="componentData.props?.alt || '图片'"
      :style="imageStyle"
    />
    <div v-else class="image-placeholder">
      <el-icon :size="24"><Picture /></el-icon>
      <span>{{ componentData.props?.alt || '图片' }}</span>
    </div>
  </div>
</template>
```
- 支持图片源、替代文本、对象适配配置
- 提供图片加载失败的占位符显示
- 响应式图片显示

**表单组件渲染器实现**

**表单渲染器 (FormRenderer.vue)**:
```vue
<template>
  <el-form
    :class="['canvas-form', componentData.props?.class]"
    :style="componentData.props?.style"
    :label-width="componentData.props?.labelWidth || '80px'"
    :label-position="componentData.props?.labelPosition || 'right'"
    :size="componentData.props?.size || 'default'"
  >
    <div class="form-placeholder">
      <el-icon><Document /></el-icon>
      <span>表单容器</span>
      <p class="form-hint">拖拽表单项到此处</p>
    </div>
  </el-form>
</template>
```
- 支持标签宽度、位置、尺寸配置
- 提供表单容器的可视化占位符
- 预留表单项拖拽区域

**选择器渲染器 (SelectRenderer.vue)**:
```vue
<template>
  <el-select
    :placeholder="componentData.props?.placeholder || '请选择'"
    :size="componentData.props?.size || 'default'"
    :disabled="componentData.props?.disabled || false"
    :clearable="componentData.props?.clearable || false"
    :multiple="componentData.props?.multiple || false"
    model-value=""
  >
    <el-option
      v-for="option in options"
      :key="option.value"
      :label="option.label"
      :value="option.value"
    />
  </el-select>
</template>
```
- 支持单选/多选、清空、禁用状态配置
- 动态选项列表渲染
- 完整的下拉选择体验

**复选框渲染器 (CheckboxRenderer.vue)**:
```vue
<template>
  <el-checkbox-group
    :size="componentData.props?.size || 'default'"
    :disabled="componentData.props?.disabled || false"
    model-value=""
  >
    <el-checkbox
      v-for="option in options"
      :key="option.value"
      :label="option.value"
      :disabled="option.disabled || false"
    >
      {{ option.label }}
    </el-checkbox>
  </el-checkbox-group>
</template>
```
- 支持复选框组配置
- 动态选项渲染
- 支持单个选项禁用

**单选框渲染器 (RadioRenderer.vue)**:
```vue
<template>
  <el-radio-group
    :size="componentData.props?.size || 'default'"
    :disabled="componentData.props?.disabled || false"
    model-value=""
  >
    <el-radio
      v-for="option in options"
      :key="option.value"
      :label="option.value"
      :disabled="option.disabled || false"
    >
      {{ option.label }}
    </el-radio>
  </el-radio-group>
</template>
```
- 支持单选框组配置
- 动态选项渲染
- 支持单个选项禁用

**布局组件渲染器实现**

**容器渲染器 (ContainerRenderer.vue)**:
```vue
<template>
  <div
    :class="['canvas-container', componentData.props?.class]"
    :style="containerStyle"
  >
    <div class="container-placeholder">
      <el-icon><Grid /></el-icon>
      <span>容器</span>
      <p class="container-hint">拖拽组件到此处</p>
    </div>
  </div>
</template>
```
- 支持容器样式和布局配置
- 提供组件拖拽区域的可视化提示
- 响应式容器布局

**栅格渲染器 (GridRenderer.vue)**:
```vue
<template>
  <el-row
    :gutter="componentData.props?.gutter || 20"
    :justify="componentData.props?.justify || 'start'"
    :align="componentData.props?.align || 'top'"
  >
    <el-col
      v-for="col in columns"
      :key="col.id"
      :span="col.span"
      :offset="col.offset || 0"
    >
      <div class="grid-col-placeholder">
        <el-icon><Grid /></el-icon>
        <span>{{ col.span }}/24</span>
      </div>
    </el-col>
  </el-row>
</template>
```
- 支持栅格间距、对齐方式配置
- 动态列配置和渲染
- 可视化栅格布局预览

**标签页渲染器 (TabsRenderer.vue)**:
```vue
<template>
  <el-tabs
    :type="componentData.props?.type || 'line'"
    :tab-position="componentData.props?.tabPosition || 'top'"
    :closable="componentData.props?.closable || false"
    model-value="tab1"
  >
    <el-tab-pane
      v-for="tab in tabs"
      :key="tab.name"
      :label="tab.label"
      :name="tab.name"
      :disabled="tab.disabled || false"
    >
      <div class="tab-content-placeholder">
        <el-icon><Folder /></el-icon>
        <span>{{ tab.label }}内容</span>
        <p class="tab-hint">拖拽组件到此处</p>
      </div>
    </el-tab-pane>
  </el-tabs>
</template>
```
- 支持标签页类型、位置、关闭按钮配置
- 动态标签页配置和渲染
- 每个标签页提供独立的组件拖拽区域

**3. 渲染器管理系统**

**渲染器映射 (renderers/index.js)**:
```javascript
import ButtonRenderer from './ButtonRenderer.vue'
import InputRenderer from './InputRenderer.vue'
import TextRenderer from './TextRenderer.vue'
import ImageRenderer from './ImageRenderer.vue'
import FormRenderer from './FormRenderer.vue'
import SelectRenderer from './SelectRenderer.vue'
import CheckboxRenderer from './CheckboxRenderer.vue'
import RadioRenderer from './RadioRenderer.vue'
import ContainerRenderer from './ContainerRenderer.vue'
import GridRenderer from './GridRenderer.vue'
import TabsRenderer from './TabsRenderer.vue'

// 组件渲染器映射
export const componentRenderers = {
  // 基础组件
  button: ButtonRenderer,
  input: InputRenderer,
  text: TextRenderer,
  image: ImageRenderer,
  // 表单组件
  form: FormRenderer,
  select: SelectRenderer,
  checkbox: CheckboxRenderer,
  radio: RadioRenderer,
  // 布局组件
  container: ContainerRenderer,
  grid: GridRenderer,
  tabs: TabsRenderer
}

// 获取组件渲染器
export function getComponentRenderer(type) {
  return componentRenderers[type] || 'div'
}
```

**4. PageLayoutDesigner集成**

**渲染器导入和使用**:
```vue
<script setup>
import { getComponentRenderer as getComponentRendererFromMap } from '../renderers/index.js'

// 获取组件渲染器
const getComponentRenderer = (type: string) => {
  return getComponentRendererFromMap(type)
}
</script>

<template>
  <component
    :is="getComponentRenderer(component.type)"
    :component-data="component"
  />
</template>
```

**5. 技术特性**

**组件属性支持**:
- **基础组件**: 支持文本、图片、按钮、输入框的完整属性配置
- **表单组件**: 支持表单容器、选择器、复选框、单选框的表单特性
- **布局组件**: 支持容器、栅格、标签页的布局和样式配置
- **样式定制**: 支持内联样式和CSS类名
- **事件绑定**: 预留事件处理接口
- **数据绑定**: 支持动态数据绑定和选项配置

**扩展性设计**:
- **新组件添加**: 只需创建新的渲染器文件并在映射中注册
- **组件升级**: 独立的渲染器文件便于维护和升级
- **类型安全**: TypeScript支持确保类型安全
- **性能优化**: 按需加载和组件缓存

**错误处理**:
- **降级渲染**: 未知组件类型降级为div元素
- **属性容错**: 缺失属性使用默认值
- **异常捕获**: 渲染异常不影响整体布局

**6. 实现效果**

**问题解决**:
- ✅ 基础组件拖拽后正确显示可视化内容
- ✅ 表单组件拖拽后显示对应的表单元素
- ✅ 布局组件拖拽后显示布局容器和占位符
- ✅ 组件属性实时反映在画布中
- ✅ 支持组件样式和交互预览
- ✅ 提供完整的组件编辑体验

**用户体验提升**:
- **所见即所得**: 画布中的组件与最终页面效果一致
- **实时预览**: 属性修改立即在画布中反映
- **直观编辑**: 可视化的组件操作和配置
- **专业体验**: 接近专业页面设计工具的使用体验

#### 步骤3: API配置 (PageApiConfig.vue)

**步骤3界面布局**:
```
┌─────────────────────────────────────────────────────────┐
│ 步骤3: API配置                                          │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────┐ ┌─────────────────────────────┐ │
│ │ API选择             │ │ API配置列表                 │ │
│ │ 系统关联配置:       │ │ ┌─────────────────────────┐ │ │
│ │ ┌─────────────────┐ │ │ │1. [GET] /api/users      │ │ │
│ │ │所属系统 [系统A▼]│ │ │ │   [串行] [编辑] [删除]  │ │ │
│ │ │所属模块 [用户▼] │ │ │ │                         │ │ │
│ │ │系统权限 [☑查看] │ │ │ │2. [POST] /api/login     │ │ │
│ │ │        [☑编辑] │ │ │ │   [并行] [编辑] [删除]  │ │ │
│ │ └─────────────────┘ │ │ │                         │ │ │
│ │                     │ │ │3. [PUT] /api/profile    │ │ │
│ │ API选择:            │ │ │   [条件] [编辑] [删除]  │ │ │
│ │ ┌─────────────────┐ │ │ └─────────────────────────┘ │ │
│ │ │选择系统 [系统A▼]│ │ │                             │ │
│ │ │选择模块 [用户▼] │ │ │ API详细配置:                │ │
│ │ │选择API [获取▼]  │ │ │ ┌─────────────────────────┐ │ │
│ │ └─────────────────┘ │ │ │请求参数:                │ │ │
│ │                     │ │ │ page: {页面数据}        │ │ │
│ │ API信息:            │ │ │ size: 10 (默认值)       │ │ │
│ │ ┌─────────────────┐ │ │ │                         │ │ │
│ │ │名称: 获取用户   │ │ │ │响应处理:                │ │ │
│ │ │方法: GET        │ │ │ │ 数据提取: data.list     │ │ │
│ │ │路径: /api/users │ │ │ │ 错误处理: 显示错误信息  │ │ │
│ │ │描述: 获取用户列表│ │ │ └─────────────────────────┘ │ │
│ │ └─────────────────┘ │ │                             │ │
│ │                     │ │                             │ │
│ │ [添加API]           │ │                             │ │
│ └─────────────────────┘ └─────────────────────────────┘ │
│                                                         │
│ API流程图:                                              │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [开始] → [API1] → [API2] → [结束]                   │ │
│ │    ↓        ↓        ↓                              │ │
│ │ [条件判断] → [API3] → [错误处理]                    │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│                [上一步] [下一步] [取消] [保存]            │
└─────────────────────────────────────────────────────────┘
```

**组件功能**: 配置页面与API的关联关系，支持API调用顺序和参数设置

**左侧API选择区域**:
- **系统关联配置**:
  - **所属系统** (必填): 下拉选择框，从系统列表中选择，确定页面归属的系统
  - **所属模块**: 下拉选择框，根据选择的系统动态加载模块列表
  - **系统权限**: 多选框，配置页面在该系统中的权限级别
- **三级选择结构**:
  - **选择系统**: 下拉选择框，显示所有可用系统（基于上面配置的所属系统）
  - **选择模块**: 下拉选择框，根据系统动态加载模块列表
  - **选择API**: 下拉选择框，显示模块下的所有API接口
- **API信息展示**:
  - API名称和请求方法（GET、POST、PUT、DELETE等）
  - API路径和描述信息
  - 请求参数和响应格式预览
- **添加API**: 点击"添加API"按钮将选中的API添加到配置列表

**右侧API配置区域**:
- **API配置列表**: 显示已添加的API配置项
  - API基本信息：名称、方法、路径
  - 执行顺序：数字序号，支持拖拽调整
  - 执行类型：串行、并行、条件执行
  - 操作按钮：编辑、删除、上移、下移
- **API详细配置**: 点击API项展开详细配置
  - **请求参数配置**:
    - 参数映射：将页面数据映射到API参数
    - 默认值设置：为参数设置默认值
    - 参数验证：配置参数验证规则
  - **响应处理配置**:
    - 数据提取：从响应中提取需要的数据
    - 数据转换：对响应数据进行格式转换
    - 错误处理：配置错误响应的处理逻辑
  - **执行条件配置**:
    - 触发条件：设置API执行的前置条件
    - 依赖关系：配置与其他API的依赖关系
    - 重试机制：配置失败重试策略

**API流程图**:
- **可视化流程**: 以流程图形式展示API调用关系
- **节点类型**:
  - 开始节点：页面加载或事件触发
  - API节点：具体的API调用
  - 条件节点：判断分支逻辑
  - 结束节点：流程结束
- **连接线**: 表示API调用的顺序和依赖关系
- **交互功能**: 支持节点拖拽、连接线编辑、流程预览

**高级配置**:
- **并发控制**: 设置并行API的最大并发数
- **超时设置**: 配置API请求超时时间
- **缓存策略**: 设置API响应缓存规则
- **错误处理**: 全局错误处理策略配置

#### 步骤4: 页面交互设置 (PageInteractionConfig.vue)

**步骤4界面布局**:
```
┌─────────────────────────────────────────────────────────┐
│ 步骤4: 页面交互设置                                     │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────┐ ┌─────────────────────────────┐ │
│ │ 事件配置            │ │ 交互流程图                  │ │
│ │ ┌─────────────────┐ │ │ ┌─────────────────────────┐ │ │
│ │ │事件列表:        │ │ │ │ [点击事件]              │ │ │
│ │ │                 │ │ │ │      ↓                  │ │ │
│ │ │1. 按钮点击 [✓]  │ │ │ │ [条件判断]              │ │ │
│ │ │   目标: btn_save│ │ │ │   ↙    ↘               │ │ │
│ │ │   动作: 2个     │ │ │ │[API调用] [UI变化]       │ │ │
│ │ │                 │ │ │ │      ↓      ↓          │ │ │
│ │ │2. 输入变化 [✓]  │ │ │ │ [成功提示] [页面跳转]   │ │ │
│ │ │   目标: input   │ │ │ └─────────────────────────┘ │ │
│ │ │   动作: 1个     │ │ │                             │ │
│ │ │                 │ │ │ 节点属性编辑:               │ │
│ │ │3. 页面加载 [✓]  │ │ │ ┌─────────────────────────┐ │ │
│ │ │   目标: 全局    │ │ │ │事件名称: 按钮点击       │ │ │
│ │ │   动作: 3个     │ │ │ │触发类型: click          │ │ │
│ │ └─────────────────┘ │ │ │触发目标: #btn_save      │ │ │
│ │                     │ │ │触发条件: 表单验证通过   │ │ │
│ │ [添加事件]          │ │ │                         │ │ │
│ │                     │ │ │执行动作:                │ │ │
│ │ 事件详细配置:       │ │ │ 1. API调用: saveData    │ │ │
│ │ ┌─────────────────┐ │ │ │ 2. 成功提示: 保存成功   │ │ │
│ │ │基本信息:        │ │ │ │ 3. 页面跳转: /list      │ │ │
│ │ │ 名称: [按钮点击]│ │ │ └─────────────────────────┘ │ │
│ │ │ 描述: [保存数据]│ │ │                             │ │
│ │ │ 启用: [✓]      │ │ │ 工具栏:                     │ │
│ │ │                 │ │ │ [预览] [验证] [导出] [重置] │ │
│ │ │触发配置:        │ │ │                             │ │
│ │ │ 类型: [点击▼]  │ │ │                             │ │
│ │ │ 目标: [#btn▼]  │ │ │                             │ │
│ │ │ 条件: [验证▼]  │ │ │                             │ │
│ │ └─────────────────┘ │ │                             │ │
│ └─────────────────────┘ └─────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│                [上一步] [完成] [取消] [保存]             │
└─────────────────────────────────────────────────────────┘
```

**组件功能**: 配置页面的交互事件和响应逻辑，支持可视化流程设计

**左侧事件配置区域**:
- **事件列表**: 显示已配置的交互事件
  - 事件名称和类型标签
  - 启用/禁用状态开关
  - 触发目标和条件信息
  - 关联动作数量统计
- **添加事件**: 点击"添加事件"按钮创建新的交互事件
- **事件详细配置**:
  - **基本信息**:
    - 事件名称：自定义事件名称
    - 事件描述：事件功能说明
    - 启用状态：是否启用该事件
  - **触发配置**:
    - 触发类型：点击、输入、变化、加载、定时等
    - 触发目标：页面元素、组件ID或全局事件
    - 触发条件：设置事件触发的前置条件
  - **执行动作**:
    - 动作类型：API调用、页面跳转、数据更新、UI变化等
    - 动作参数：配置动作执行的具体参数
    - 执行顺序：多个动作的执行顺序设置

**右侧交互流程图**:
- **流程可视化**: 以流程图形式展示交互事件的执行流程
- **节点类型**:
  - 事件节点：用户交互事件（点击、输入等）
  - 条件节点：判断逻辑分支
  - 动作节点：具体执行动作
  - API节点：API调用动作
  - 结果节点：执行结果处理
- **连接关系**: 表示事件流转的逻辑关系
- **交互功能**:
  - 节点拖拽：调整节点位置
  - 连接编辑：修改节点间的连接关系
  - 属性编辑：双击节点编辑属性
  - 流程预览：模拟执行流程

**事件类型支持**:
- **用户交互事件**:
  - 点击事件：按钮点击、链接点击等
  - 输入事件：文本输入、选择变化等
  - 鼠标事件：悬停、拖拽、右键等
  - 键盘事件：按键、快捷键等
- **页面生命周期事件**:
  - 页面加载：页面初始化完成
  - 页面卸载：页面销毁前
  - 数据变化：数据状态变化
- **定时事件**:
  - 延时执行：设定时间后执行
  - 定时轮询：定期执行某个动作
  - 条件轮询：满足条件时执行

**动作类型支持**:
- **API调用动作**: 调用已配置的API接口
- **页面导航动作**: 页面跳转、返回、刷新等
- **数据操作动作**: 数据更新、清空、验证等
- **UI变化动作**: 显示/隐藏、样式变化、动画效果等
- **消息提示动作**: 成功提示、错误提示、确认对话框等

**高级功能**:
- **条件分支**: 支持复杂的条件判断逻辑
- **循环执行**: 支持循环和迭代操作
- **异常处理**: 配置异常情况的处理逻辑
- **状态管理**: 页面状态的保存和恢复

#### 步骤2: 页面布局设计

**可视化布局编辑器**:
- **画布区域**: 可拖放组件的设计画布
  - 网格辅助线显示
  - 组件对齐辅助线
  - 画布缩放功能（25%-200%）
  - 响应式预览模式（桌面/平板/移动）

**组件库面板**:
- **基础组件**: 按钮、输入框、文本、图片、分割线
- **表单组件**: 表单容器、各类输入控件、验证组件
- **数据展示**: 表格、列表、卡片、统计图表
- **布局组件**: 容器、栅格、分栏、标签页
- **交互组件**: 弹框、抽屉、下拉菜单、导航

**拖拽功能**:
- **组件拖拽**: 从组件库拖拽到画布
- **位置调整**: 拖拽调整组件位置
- **尺寸调整**: 拖拽调整组件大小
- **层级管理**: 组件层级调整（置顶/置底）

**实时预览**:
- **预览区域**: 右侧或下方实时效果预览
- **设备预览**: 支持不同设备尺寸预览
- **交互预览**: 支持基础交互效果预览

#### 步骤3: API配置（重点功能）

**API选择方式**:
- **三级选择结构**: 系统 → 模块 → 具体API
  - **系统选择**: 下拉选择框，显示所有可用系统
  - **模块选择**: 根据选择的系统动态加载模块列表
  - **API选择**: 从模块下的API列表中选择，显示API名称、方法、路径

**API调用顺序配置**:
- **可视化流程图**: 展示API调用顺序和关系
  - 节点表示API接口
  - 连线表示调用关系
  - 支持拖拽调整顺序
- **调用类型配置**:
  - **串行调用**: API按顺序执行，前一个API结果作为后一个输入
  - **并行调用**: 多个API同时执行，配置完成后的回调处理
  - **条件调用**: 根据前一个API结果决定是否调用后续API
- **调用时序配置**:
  - API调用延迟设置
  - 超时时间配置
  - 重试次数和间隔

**特殊API配置**:
- **上传图片接口**: 专门的文件上传API配置
  - 上传地址和参数配置
  - 文件类型限制（图片格式、大小限制）
  - 上传进度显示配置
  - 多文件上传支持
  - 预览功能配置

**API参数配置**:
- **请求参数映射**: 页面数据与API参数的绑定关系
  - 静态参数配置
  - 动态参数绑定（从页面组件获取）
  - 参数转换规则
- **响应数据处理**: API返回数据的提取和转换
  - 数据提取路径配置
  - 数据格式转换
  - 错误数据处理
- **错误处理配置**: API调用失败时的处理方式
  - 错误提示配置
  - 重试策略
  - 降级处理

#### 步骤4: 页面交互设置

**交互事件配置**:
- **事件类型**: 
  - 点击事件 (click)
  - 悬停事件 (hover)
  - 数据变化 (change)
  - 页面加载 (load)
  - 表单提交 (submit)
  - 自定义事件 (custom)

**触发条件配置**:
- **条件表达式**: 支持复杂条件逻辑配置
- **数据条件**: 基于页面数据的条件判断
- **状态条件**: 基于组件状态的条件判断
- **时间条件**: 基于时间的条件判断

**执行动作配置**:
- **页面操作**: 跳转页面、刷新页面、返回上页
- **组件操作**: 显示/隐藏元素、启用/禁用组件、更新组件数据
- **API调用**: 触发配置的API调用
- **用户反馈**: 弹出提示、显示消息、播放音效
- **数据操作**: 保存数据、清空数据、数据验证

**可视化交互流程图**:
- **流程节点**: 表示交互步骤
- **条件分支**: 支持if/else等条件逻辑
- **循环控制**: 支持循环和迭代逻辑
- **异常处理**: 异常情况的处理流程

#### 其他功能特性

**配置管理**:
- **保存/加载**: 可保存当前配置为模板，或加载已有模板
- **版本管理**: 查看和恢复历史配置版本
- **配置验证**: 保存前验证配置的完整性和一致性
- **导入/导出**: 支持JSON格式的配置导入导出

**用户体验优化**:
- **步骤引导**: 清晰的步骤指示和进度显示
- **实时保存**: 自动保存草稿，防止数据丢失
- **撤销/重做**: 支持操作的历史记录和回退
- **帮助提示**: 关键配置项有详细说明和示例
- **快捷操作**: 支持键盘快捷键和右键菜单
- **响应式设计**: 适配不同屏幕尺寸

**表单验证规则**:
- **步骤1验证**: 页面名称必填，路径格式验证，系统选择必填
- **步骤2验证**: 布局完整性检查，组件配置验证
- **步骤3验证**: API配置完整性，参数映射正确性
- **步骤4验证**: 交互逻辑一致性，事件配置完整性

**交互特性**:
- **步骤导航**: 支持点击步骤标题直接跳转
- **数据联动**: 各步骤间数据自动同步
- **实时预览**: 配置变更实时反映到预览区域
- **智能提示**: 根据配置提供智能建议
- **批量操作**: 支持批量配置相似组件或API

#### 编辑页面
1. **触发操作**: 点击页面卡片的"编辑"按钮
2. **加载数据**: 获取页面详细信息和配置数据
3. **打开配置弹框**: 弹出步骤向导式页面配置对话框（编辑模式）
4. **数据预填充**: 自动填充现有数据到各个步骤
5. **步骤编辑**: 用户可在任意步骤进行修改
   - **步骤1**: 编辑基本信息（某些关键字段可能被禁用）
   - **步骤2**: 修改页面布局和组件配置
   - **步骤3**: 调整API配置和调用关系
   - **步骤4**: 更新交互设置和事件配置
6. **实时验证**: 修改时进行数据验证
7. **保存更新**: 提交修改请求
8. **状态更新**: 更新列表中的页面信息

**编辑模式特性**:
- **组件复用**: 使用与新增相同的`PageConfigDialog`组件
- **完整数据预填充**: 自动填充页面的所有配置信息到各步骤
- **字段限制**: 某些关键字段(如所属系统)在编辑模式下被禁用
- **布局保持**: 保留现有的页面布局和组件配置
- **API关联保持**: 保留现有的API关联关系和调用配置
- **交互保持**: 保留现有的交互事件和流程配置
- **增量更新**: 只提交发生变化的配置数据
- **版本控制**: 支持并发编辑检测，防止配置覆盖
- **实时同步**: 编辑时各步骤间数据实时同步
- **配置验证**: 保存前验证整体配置的一致性和完整性

#### 删除页面
1. **触发操作**: 点击"删除"按钮
2. **依赖检查**: 检查页面是否有关联的API或测试用例
3. **确认对话框**: 显示删除确认提示和影响范围
4. **执行删除**: 发送删除请求
5. **级联处理**: 处理关联数据的删除或解绑
6. **列表更新**: 从列表中移除已删除项
7. **消息提示**: 显示删除成功消息

### API关联管理

#### 查看页面API
1. **触发操作**: 点击"API管理"按钮
2. **打开API面板**: 显示页面API关联管理界面
3. **API列表展示**: 显示当前页面关联的所有API
4. **API信息显示**: 展示API名称、方法、路径、状态等

#### 添加API关联
1. **点击添加**: 点击"添加API"按钮
2. **API选择器**: 打开API选择对话框
3. **筛选搜索**: 通过系统、模块、名称筛选API
4. **多选API**: 支持批量选择多个API
5. **关联配置**: 设置API在页面中的作用和参数
6. **确认添加**: 建立页面与API的关联关系
7. **列表更新**: 刷新页面API列表

#### 编辑API关联
1. **选择API**: 点击已关联API的编辑按钮
2. **编辑配置**: 修改API在页面中的配置
3. **参数设置**: 调整API调用参数和响应处理
4. **保存更改**: 更新关联配置
5. **状态同步**: 同步API关联状态

#### 删除API关联
1. **选择API**: 点击要删除的API关联
2. **确认删除**: 显示删除确认对话框
3. **解除关联**: 删除页面与API的关联关系
4. **影响评估**: 提示删除对测试用例的影响
5. **列表更新**: 从关联列表中移除API

### 批量操作
1. **选择页面**: 勾选多个页面项目
2. **选择操作**: 从批量操作菜单选择
   - 批量删除页面
   - 批量更新状态
   - 批量修改分类
   - 批量导出数据
3. **确认执行**: 显示批量操作确认对话框
4. **执行操作**: 并行处理选中的页面
5. **进度显示**: 显示批量操作进度
6. **结果汇总**: 展示操作结果统计

### 导入导出功能

#### 导入页面
1. **选择文件**: 点击导入按钮，选择文件
2. **格式验证**: 验证文件格式（JSON、Excel等）
3. **数据预览**: 显示导入数据预览
4. **冲突处理**: 处理重复页面的策略选择
5. **关联处理**: 处理页面API关联的导入
6. **执行导入**: 批量创建页面和关联
7. **结果报告**: 显示导入成功/失败统计

#### 导出页面
1. **选择范围**: 选择导出的页面范围
2. **选择格式**: 选择导出格式（JSON、Excel、CSV）
3. **配置选项**: 设置导出字段和关联数据
4. **生成文件**: 创建导出文件
5. **下载文件**: 提供文件下载链接

## 响应式设计

### 桌面端 (>1200px)
- 左侧导航固定宽度 280px
- 右侧内容区域自适应
- 页面表格完整显示所有列
- 完整显示所有操作按钮
- API管理面板侧边栏显示

### 平板端 (768px-1200px)
- 左侧导航可折叠
- 页面表格隐藏部分次要列（如创建时间）
- 部分操作按钮收缩到下拉菜单
- API管理面板全屏显示

### 移动端 (<768px)
- 左侧导航抽屉式显示
- 页面表格转为卡片式布局
- 操作按钮简化为图标
- 搜索筛选区域垂直排列
- API管理面板全屏模态框

## 键盘快捷键

- `Ctrl/Cmd + N`: 新增页面
- `Ctrl/Cmd + F`: 聚焦搜索框
- `Ctrl/Cmd + R`: 刷新列表
- `Ctrl/Cmd + A`: 全选页面（批量操作模式）
- `Escape`: 关闭对话框或面板
- `Enter`: 确认操作
- `Tab`: 在表单字段间切换
- `Ctrl/Cmd + M`: 打开API管理面板

## 加载状态和反馈

### 加载状态
- **页面初始化**: 骨架屏显示
- **搜索加载**: 搜索框显示加载图标
- **页面操作**: 按钮显示加载状态
- **API关联加载**: API面板显示加载动画
- **批量操作**: 进度条显示

### 用户反馈
- **成功操作**: 绿色Toast消息
- **错误处理**: 红色错误提示
- **警告信息**: 橙色警告提示（如删除有依赖的页面）
- **信息提示**: 蓝色信息提示

### 空状态处理
- **无页面数据**: 显示空状态插画和引导
- **搜索无结果**: 提供搜索建议
- **无API关联**: 显示添加API的引导
- **网络错误**: 显示重试按钮

## 特殊交互场景

### API关联冲突处理
1. **冲突检测**: 检测API参数冲突或重复关联
2. **冲突提示**: 明确显示冲突原因和影响
3. **解决方案**: 提供冲突解决选项
4. **自动修复**: 支持自动修复简单冲突

### 页面依赖管理
1. **依赖检查**: 检查页面的测试用例依赖
2. **影响分析**: 分析删除或修改的影响范围
3. **依赖可视化**: 图形化显示页面依赖关系
4. **安全操作**: 提供安全的依赖解除方案

### 版本控制
1. **变更记录**: 记录页面的所有变更历史
2. **版本对比**: 支持不同版本的对比查看
3. **回滚功能**: 支持回滚到历史版本
4. **变更审核**: 重要变更需要审核确认

## 常见问题与解决方案

### 性能优化
- **虚拟表格**: 大量页面数据时使用虚拟表格
- **表格优化**: 固定表头、列宽自适应
- **分页加载**: 每页显示 20-100 条数据
- **搜索防抖**: 输入延迟 300ms 后执行搜索
- **缓存策略**: 缓存页面列表和筛选结果
- **API关联缓存**: 缓存页面API关联数据
- **懒加载**: 延迟加载页面详细信息

### 用户体验
- **操作确认**: 重要操作提供二次确认
- **撤销功能**: 支持删除操作的撤销
- **自动保存**: 表单数据自动保存草稿
- **快速操作**: 提供常用操作的快捷方式
- **智能推荐**: 根据页面类型推荐相关API

### 错误处理
- **网络异常**: 提供重试机制
- **权限不足**: 明确提示权限要求
- **数据冲突**: 提供冲突解决方案
- **表单验证**: 实时验证和错误提示
- **API关联错误**: 详细的关联错误信息

## 接口调用说明

### 前端API接口

#### 页面管理接口
```javascript
// 获取页面列表
pageApi.getPageList(params)
// 参数: { system_id?, module_id?, keyword?, page_type?, status?, page?, size? }
// 返回: Promise<ApiResponse>

// 根据ID获取页面详情
pageApi.getPageById(pageId)
// 参数: pageId (string)
// 返回: Promise<ApiResponse>

// 创建页面
pageApi.createPage(data)
// 参数: { name, description, route, page_type, system_id, module_id, enabled }
// 返回: Promise<ApiResponse>

// 更新页面
pageApi.updatePage(pageId, data)
// 参数: pageId (string), data (Partial<PageData>)
// 返回: Promise<ApiResponse>

// 删除页面
pageApi.deletePage(pageId)
// 参数: pageId (string)
// 返回: Promise<ApiResponse>

// 搜索页面
pageApi.searchPages(params)
// 参数: { keyword?, system_id?, module_id?, page_type?, status? }
// 返回: Promise<ApiResponse>
```

#### 页面API关联管理
```javascript
// 获取页面的API列表
pageApi.getPageApis(pageId, params)
// 参数: pageId (string), params ({ keyword?, method?, status? })
// 返回: Promise<ApiResponse>

// 为页面添加API关联
pageApi.addPageApi(pageId, data)
// 参数: pageId (string), data ({ api_id, execution_type, order })
// 返回: Promise<ApiResponse>

// 更新页面API关联
pageApi.updatePageApi(pageId, apiId, data)
// 参数: pageId (string), apiId (string), data (Partial<PageApiData>)
// 返回: Promise<ApiResponse>

// 删除页面API关联
pageApi.deletePageApi(pageId, apiId)
// 参数: pageId (string), apiId (string)
// 返回: Promise<ApiResponse>

// 批量管理页面API关联
pageApi.batchManagePageApis(pageId, data)
// 参数: pageId (string), data ({ add_apis?, remove_apis?, update_apis? })
// 返回: Promise<ApiResponse>
```

#### 批量操作接口
```javascript
// 批量启用页面
pageApi.batchEnable(pageIds)
// 参数: pageIds (string[])
// 返回: Promise<ApiResponse>

// 批量禁用页面
pageApi.batchDisable(pageIds)
// 参数: pageIds (string[])
// 返回: Promise<ApiResponse>

// 批量删除页面
pageApi.batchDelete(pageIds)
// 参数: pageIds (string[])
// 返回: Promise<ApiResponse>

// 批量导出页面
pageApi.batchExport(pageIds)
// 参数: pageIds (string[])
// 返回: Promise<Blob>
```

#### 统计和配置接口
```javascript
// 获取页面统计概览
pageApi.getPageStats()
// 返回: Promise<ApiResponse<PageStats>>

// 获取页面类型列表
pageApi.getPageTypes()
// 返回: Promise<ApiResponse<PageType[]>>

// 获取执行类型列表
pageApi.getExecutionTypes()
// 返回: Promise<ApiResponse<ExecutionType[]>>
```

### 后端API接口

#### 页面管理 (`/pages/v1/`)

| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| GET | `/pages/v1/` | 获取页面列表 | system_id?, module_id?, keyword?, page_type?, status?, page?, size? |
| GET | `/pages/v1/{page_id}` | 获取页面详情 | page_id |
| POST | `/pages/v1/` | 创建页面 | PageCreate对象 |
| PUT | `/pages/v1/{page_id}` | 更新页面 | page_id, PageUpdate对象 |
| DELETE | `/pages/v1/{page_id}` | 删除页面 | page_id |
| POST | `/pages/v1/search` | 搜索页面 | PageQueryRequest对象 |

#### 分步保存接口 (`/pages/v1/`)

| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| POST | `/pages/v1/{page_id}/step/basic` | 保存基本信息步骤 | page_id, PageBasicInfo对象 |
| POST | `/pages/v1/{page_id}/step/layout` | 保存布局设计步骤 | page_id, PageLayout对象 |
| POST | `/pages/v1/{page_id}/step/api` | 保存API配置步骤 | page_id, PageApiConfig对象 |
| POST | `/pages/v1/{page_id}/step/interaction` | 保存交互设置步骤 | page_id, PageInteraction对象 |
| GET | `/pages/v1/{page_id}/progress` | 获取配置进度 | page_id |
| POST | `/pages/v1/{page_id}/complete` | 完成页面配置 | page_id |

#### 页面API关联管理
| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| GET | `/pages/v1/{page_id}/apis` | 获取页面的API列表 | page_id, keyword?, method?, status? |
| POST | `/pages/v1/{page_id}/apis` | 为页面添加API关联 | page_id, PageApiCreate对象 |
| PUT | `/pages/v1/{page_id}/apis/{api_id}` | 更新页面API关联 | page_id, api_id, PageApiUpdate对象 |
| DELETE | `/pages/v1/{page_id}/apis/{api_id}` | 删除页面API关联 | page_id, api_id |
| POST | `/pages/v1/{page_id}/apis/batch` | 批量管理页面API关联 | page_id, PageApiBatchRequest对象 |

#### 批量操作
| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| POST | `/pages/v1/batch/enable` | 批量启用页面 | page_ids (List[int]) |
| POST | `/pages/v1/batch/disable` | 批量禁用页面 | page_ids (List[int]) |
| POST | `/pages/v1/batch/delete` | 批量删除页面 | page_ids (List[int]) |
| POST | `/pages/v1/batch/status` | 批量更新状态 | PageBatchRequest对象 |

#### 数据导入导出
| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| GET | `/pages/v1/export/data` | 导出页面数据 | system_id?, status? |
| POST | `/pages/v1/import/data` | 导入页面数据 | pages_data (List[PageCreate]) |

#### 统计和配置
| 方法 | 路径 | 功能 | 参数 |
|------|------|------|------|
| GET | `/pages/v1/stats/summary` | 获取页面统计 | 无 |
| GET | `/pages/v1/types/list` | 获取页面类型列表 | 无 |
| GET | `/pages/v1/execution-types/list` | 获取执行类型列表 | 无 |

### 数据模型

#### PageCreate
```typescript
interface PageCreate {
  name: string              // 页面名称
  description?: string      // 页面描述
  route: string            // 页面路由
  page_type: string        // 页面类型
  system_id: number        // 所属系统ID
  module_id?: number       // 所属模块ID
  enabled: boolean         // 是否启用
  tags?: string[]          // 标签列表
  config?: object          // 页面配置
  metadata?: object        // 元数据
}
```

#### PageUpdate
```typescript
interface PageUpdate {
  name?: string
  description?: string
  route?: string
  page_type?: string
  enabled?: boolean
  tags?: string[]
  config?: object
  metadata?: object
}
```

#### PageQueryRequest
```typescript
interface PageQueryRequest {
  system_id?: number       // 系统ID筛选
  module_id?: number       // 模块ID筛选
  keyword?: string         // 搜索关键词
  page_type?: string       // 页面类型筛选
  status?: string          // 状态筛选
  page?: number           // 页码
  size?: number           // 每页数量
}
```

#### PageApiCreate
```typescript
interface PageApiCreate {
  api_id: number           // API接口ID
  execution_type: string   // 执行类型
  order?: number          // 执行顺序
  config?: object         // 配置信息
  enabled: boolean        // 是否启用
}
```

#### PageApiUpdate
```typescript
interface PageApiUpdate {
  execution_type?: string
  order?: number
  config?: object
  enabled?: boolean
}
```

#### PageApiBatchRequest
```typescript
interface PageApiBatchRequest {
  add_apis?: PageApiCreate[]     // 要添加的API关联
  remove_apis?: number[]         // 要移除的API ID列表
  update_apis?: {               // 要更新的API关联
    api_id: number
    data: PageApiUpdate
  }[]
}
```

#### PageBatchRequest
```typescript
interface PageBatchRequest {
  page_ids: number[]       // 页面ID列表
  action: string          // 操作类型: enable, disable, delete
  data?: object           // 附加数据
}
```

#### 分步保存数据模型

#### PageBasicInfo
```typescript
interface PageBasicInfo {
  name: string              // 页面名称
  description?: string      // 页面描述
  route?: string           // 页面路由
  page_type: string        // 页面类型
  system_id: number        // 所属系统ID
  module_id?: number       // 所属模块ID
  enabled: boolean         // 是否启用
  icon?: string           // 页面图标
  permissions?: string[]   // 权限设置
}
```

#### PageLayout
```typescript
interface PageLayout {
  components: ComponentConfig[]  // 组件配置列表
  layout_type: string           // 布局类型
  responsive: boolean           // 是否响应式
  grid_config?: GridConfig      // 网格配置
  theme?: ThemeConfig          // 主题配置
}

interface ComponentConfig {
  id: string                   // 组件ID
  type: string                // 组件类型
  props: object               // 组件属性
  style: object               // 样式配置
  position: Position          // 位置信息
  children?: ComponentConfig[] // 子组件
}
```

#### PageApiConfig
```typescript
interface PageApiConfig {
  system_id: number           // 系统ID
  module_id: number          // 模块ID
  apis: ApiConfigItem[]      // API配置列表
}

interface ApiConfigItem {
  api_id: number             // API ID
  execution_type: string     // 执行类型: serial, parallel, conditional
  order: number             // 执行顺序
  params_mapping?: object   // 参数映射
  response_handling?: object // 响应处理
  enabled: boolean          // 是否启用
}
```

#### PageInteraction
```typescript
interface PageInteraction {
  events: InteractionEvent[]     // 交互事件列表
  workflows: WorkflowConfig[]    // 工作流配置
}

interface InteractionEvent {
  id: string                    // 事件ID
  trigger: EventTrigger         // 触发条件
  actions: EventAction[]        // 执行动作
  enabled: boolean             // 是否启用
}
```

#### PageProgress
```typescript
interface PageProgress {
  page_id: number              // 页面ID
  current_step: number         // 当前步骤
  completed_steps: number[]    // 已完成步骤
  step_status: {              // 步骤状态
    basic: 'completed' | 'draft' | 'pending'
    layout: 'completed' | 'draft' | 'pending'
    api: 'completed' | 'draft' | 'pending'
    interaction: 'completed' | 'draft' | 'pending'
  }
  last_saved_at: string       // 最后保存时间
  is_completed: boolean       // 是否完成配置
}
```

## 最佳实践

### 页面管理建议
1. **清晰命名**: 使用描述性的页面名称和路由
2. **合理分类**: 按功能模块组织页面结构
3. **完整描述**: 提供详细的页面功能描述
4. **及时更新**: 保持页面信息的时效性

### API关联管理
1. **精准关联**: 只关联页面真正需要的API
2. **参数配置**: 正确配置API调用参数
3. **状态同步**: 保持API状态与页面状态一致
4. **定期检查**: 定期检查API关联的有效性

### 团队协作
1. **命名规范**: 统一页面命名和路由规范
2. **文档标准**: 建立页面文档编写标准
3. **审核流程**: 建立页面创建和修改审核机制
4. **知识共享**: 定期分享页面管理经验

### 数据管理
1. **备份导出**: 定期导出页面数据备份
2. **版本控制**: 记录页面的变更历史
3. **权限管理**: 合理设置页面的访问权限
4. **监控告警**: 设置页面状态监控