# 共享组件交互文档

## 组件概述

共享组件是自动化测试平台中被多个页面复用的UI组件，主要包括SystemTree（系统树）、统一搜索组件、数据表格组件、表单组件等。这些组件提供了一致的用户体验和交互模式。

## SystemTree 组件

### 组件概述
SystemTree是平台中最重要的共享组件，用于展示系统的层级结构，在系统管理、API管理、页面管理等多个页面中使用。

### 界面布局
```
┌─────────────────────────────────┐
│ SystemTree 组件                  │
├─────────────────────────────────┤
│ [搜索框: 搜索系统/模块]          │
├─────────────────────────────────┤
│ ┌─ 📁 系统A (15)               │
│ │   ├─ 📂 模块A1 (8)           │
│ │   │   ├─ 📄 子模块A1-1 (3)   │
│ │   │   └─ 📄 子模块A1-2 (5)   │
│ │   └─ 📂 模块A2 (7)           │
│ │       ├─ 📄 子模块A2-1 (4)   │
│ │       └─ 📄 子模块A2-2 (3)   │
│ ├─ 📁 系统B (23)               │
│ │   ├─ 📂 模块B1 (12)          │
│ │   └─ 📂 模块B2 (11)          │
│ └─ 📁 系统C (8)                │
│     └─ 📂 模块C1 (8)           │
└─────────────────────────────────┘
```

### 交互行为

#### 节点展开/折叠
1. **点击展开图标**: 
   - 展开/折叠节点
   - 动画效果：200ms缓动动画
   - 状态记忆：记住用户的展开状态

2. **双击节点**:
   - 快速展开/折叠节点
   - 同时选中该节点

3. **键盘操作**:
   - `→`: 展开当前节点
   - `←`: 折叠当前节点
   - `↑/↓`: 上下导航
   - `Enter`: 选中节点

#### 节点选择
1. **单击选择**:
   - 高亮选中节点
   - 触发选择事件
   - 更新右侧内容区域

2. **选中状态**:
   - 背景色变化：蓝色高亮
   - 文字颜色：白色
   - 左侧指示条：蓝色竖线

#### 搜索功能
1. **实时搜索**:
   - 输入关键词
   - 300ms防抖延迟
   - 高亮匹配结果
   - 自动展开包含匹配项的父节点

2. **搜索结果**:
   - 匹配的节点高亮显示
   - 非匹配节点变灰
   - 显示匹配数量
   - 支持清空搜索

#### 数量显示
1. **节点计数**:
   - 显示每个节点下的项目数量
   - 实时更新计数
   - 括号内显示：`系统A (15)`

2. **计数规则**:
   - 系统节点：显示该系统下所有API/页面数量
   - 模块节点：显示该模块下的API/页面数量
   - 动态更新：数据变化时自动更新

### 响应式设计
- **桌面端**: 固定宽度280px，完整显示节点信息
- **平板端**: 可折叠，宽度240px
- **移动端**: 抽屉式显示，全屏宽度

### 状态管理
- **选中状态**: 记录当前选中的节点
- **展开状态**: 记录所有展开的节点
- **搜索状态**: 记录搜索关键词和结果

## 统一搜索组件 (UnifiedSearch)

### 组件概述
统一搜索组件提供了一致的搜索体验，支持关键词搜索、高级筛选、搜索历史等功能。

### 界面布局
```
┌─────────────────────────────────────────────────────────┐
│ [🔍] [搜索框: 输入关键词...]  [搜索] [高级筛选▼] [重置] │
├─────────────────────────────────────────────────────────┤
│ 高级筛选面板 (可展开)                                    │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ [类型▼] [状态▼] [时间范围▼] [标签▼] [更多筛选▼]    │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ 搜索历史 (下拉显示)                                      │
│ • 最近搜索的关键词1                                      │
│ • 最近搜索的关键词2                                      │
│ • 最近搜索的关键词3                                      │
└─────────────────────────────────────────────────────────┘
```

### 交互行为

#### 基础搜索
1. **输入搜索**:
   - 实时输入提示
   - 300ms防抖处理
   - 自动完成建议
   - 搜索历史显示

2. **搜索执行**:
   - 点击搜索按钮
   - 按Enter键触发
   - 显示加载状态
   - 更新搜索结果

#### 高级筛选
1. **筛选面板**:
   - 点击展开/折叠
   - 动画过渡效果
   - 筛选条件组合
   - 实时筛选结果

2. **筛选操作**:
   - 多选下拉框
   - 日期范围选择
   - 标签多选
   - 自定义筛选条件

#### 搜索历史
1. **历史记录**:
   - 保存最近10次搜索
   - 点击快速搜索
   - 删除历史记录
   - 清空所有历史

## 数据表格组件 (DataTable)

### 组件概述
数据表格组件提供了统一的数据展示和操作功能，支持排序、筛选、分页、批量操作等。

### 界面布局
```
┌─────────────────────────────────────────────────────────┐
│ 表格工具栏                                               │
│ [批量操作▼] [列设置] [导出] [刷新]    [密度▼] [全屏]    │
├─────────────────────────────────────────────────────────┤
│ ┌─┬─────────┬─────────┬─────────┬─────────┬─────────┐   │
│ │☐│ 名称 ↑  │ 类型    │ 状态    │ 时间    │ 操作    │   │
│ ├─┼─────────┼─────────┼─────────┼─────────┼─────────┤   │
│ │☐│ 项目1   │ API     │ 启用    │ 今天    │ [编辑]  │   │
│ │☐│ 项目2   │ 页面    │ 禁用    │ 昨天    │ [删除]  │   │
│ │☐│ 项目3   │ 系统    │ 启用    │ 2天前   │ [查看]  │   │
│ └─┴─────────┴─────────┴─────────┴─────────┴─────────┘   │
├─────────────────────────────────────────────────────────┤
│ 分页控件                                                 │
│ 共 156 条 [10条/页▼] [1] [2] [3] ... [16] [下一页>]    │
└─────────────────────────────────────────────────────────┘
```

### 交互行为

#### 表格操作
1. **排序功能**:
   - 点击列标题排序
   - 升序/降序切换
   - 多列排序支持
   - 排序状态指示

2. **列管理**:
   - 显示/隐藏列
   - 列宽调整
   - 列顺序拖拽
   - 固定列设置

3. **行选择**:
   - 单行选择
   - 多行选择
   - 全选/反选
   - 跨页选择

#### 批量操作
1. **批量选择**:
   - 复选框选择
   - Shift连续选择
   - Ctrl多选
   - 选择状态提示

2. **批量操作菜单**:
   - 批量删除
   - 批量编辑
   - 批量导出
   - 自定义操作

#### 数据展示
1. **数据密度**:
   - 紧凑模式
   - 标准模式
   - 宽松模式
   - 用户偏好记忆

2. **数据格式化**:
   - 时间格式化
   - 数字格式化
   - 状态标签
   - 自定义渲染

## 表单组件 (FormComponents)

### 组件概述
表单组件提供了统一的表单输入体验，包括各种输入控件、验证规则、布局模式等。

### 常用表单控件

#### 输入框 (Input)
```
┌─────────────────────────────────────┐
│ 标签名称 *                           │
│ ┌─────────────────────────────────┐ │
│ │ 输入内容...                     │ │
│ └─────────────────────────────────┘ │
│ 帮助文本或错误提示                   │
└─────────────────────────────────────┘
```

#### 下拉选择 (Select)
```
┌─────────────────────────────────────┐
│ 选择类型 *                           │
│ ┌─────────────────────────────────┐ │
│ │ 请选择...                    ▼ │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ ☐ 选项1                         │ │
│ │ ☑ 选项2                         │ │
│ │ ☐ 选项3                         │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

### 交互行为

#### 表单验证
1. **实时验证**:
   - 失焦时验证
   - 输入时验证
   - 提交时验证
   - 错误状态显示

2. **验证规则**:
   - 必填验证
   - 格式验证
   - 长度验证
   - 自定义验证

#### 表单提交
1. **提交流程**:
   - 表单验证
   - 数据收集
   - 提交请求
   - 结果反馈

2. **提交状态**:
   - 加载状态
   - 成功状态
   - 错误状态
   - 禁用状态

## 通用交互模式

### 加载状态
1. **骨架屏**: 初始加载时显示
2. **加载动画**: 数据请求时显示
3. **按钮加载**: 操作执行时显示
4. **进度条**: 长时间操作显示

### 反馈机制
1. **Toast消息**: 操作结果反馈
2. **确认对话框**: 重要操作确认
3. **提示信息**: 操作指导
4. **错误处理**: 错误信息展示

### 响应式适配
1. **断点设置**:
   - 移动端: <768px
   - 平板端: 768px-1200px
   - 桌面端: >1200px

2. **适配策略**:
   - 布局调整
   - 组件简化
   - 交互优化
   - 性能优化

## 无障碍支持

### 键盘导航
1. **Tab导航**: 支持Tab键在组件间切换
2. **方向键**: 支持方向键在选项间导航
3. **快捷键**: 提供常用操作快捷键
4. **焦点管理**: 合理的焦点顺序和指示

### 屏幕阅读器
1. **语义标签**: 使用正确的HTML语义
2. **ARIA属性**: 提供必要的ARIA标签
3. **文本描述**: 为图标和操作提供文本描述
4. **状态通知**: 状态变化的语音通知

### 视觉辅助
1. **高对比度**: 支持高对比度模式
2. **字体缩放**: 支持字体大小调整
3. **颜色辅助**: 不仅依赖颜色传达信息
4. **动画控制**: 支持减少动画效果

## 性能优化

### 组件优化
1. **懒加载**: 按需加载组件
2. **虚拟滚动**: 大数据量时使用
3. **缓存策略**: 缓存组件状态
4. **防抖节流**: 优化频繁操作

### 渲染优化
1. **React.memo**: 避免不必要的重渲染
2. **useMemo**: 缓存计算结果
3. **useCallback**: 缓存函数引用
4. **代码分割**: 按需加载代码

## 最佳实践

### 组件设计
1. **单一职责**: 每个组件只负责一个功能
2. **可复用性**: 设计通用的组件接口
3. **可扩展性**: 支持自定义和扩展
4. **一致性**: 保持设计和交互的一致性

### 状态管理
1. **状态提升**: 合理提升共享状态
2. **状态分离**: 分离本地和全局状态
3. **状态持久化**: 重要状态的持久化
4. **状态同步**: 保持状态的一致性

### 用户体验
1. **响应速度**: 快速的交互响应
2. **视觉反馈**: 清晰的状态反馈
3. **错误处理**: 友好的错误提示
4. **帮助指导**: 提供操作指导和帮助